{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "478337f4_3f4ae5f3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1000520
      },
      "writtenOn": "2022-11-25T21:11:51Z",
      "side": 1,
      "message": "It still looks good to me, but I will let Patrick Williams make the final decision.\n",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3fa7688_e0992e2c",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2022-11-28T21:32:39Z",
      "side": 1,
      "message": "Shouldn\u0027t we make separate zone instances for each zone instead of having magic strings?\n\nMaybe I\u0027m not understanding what the value besides \"All\" are based on the limited documentation.  How does someone programmatically determine the valid values here?",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3530a0cd_99da1922",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1001618
      },
      "writtenOn": "2022-11-29T02:33:50Z",
      "side": 1,
      "message": "Hi Patrick,\n\nThe interface Control.FanZone will be added to seperate fan zone object.\n- For example: zone1\n\u003e    root@greatlakes:~# busctl introspect xyz.openbmc_project.State.FanCtrl /xyz/openbmc_project/settings/fanctrl/zone1                                          NAME                                TYPE      SIGNATURE RESULT/VALUE FLAGS\n\u003e    ...\n\u003e    xyz.openbmc_project.Control.FanZone interface -         -            -\n\u003e    .ManualPwm                          property  (sd)      \"\" 0         emits-change writable\n\u003e    xyz.openbmc_project.Control.Mode    interface -         -            -\n\u003e    .FailSafe                           property  b         false        emits-change writable\n\u003e    .Manual                             property  b         false        emits-change writable\n    \nIf we use \u0027All\u0027 for the string of ManualPwm, we can set PWM for all PWM sensors in zone 1.\n\nYou can also control specific PWM sensor in the zone by using the sensor name listed in the \"inputs\" section of the fan table. \n- For example, using \"BB_FAN0_TACH_RPM\" as the string of ManualPwm to set the PWM of PWM 1.\n\u003e    \"sensors\": [\n\u003e    {\n\u003e        \"name\": \"BB_FAN0_TACH_RPM\",\n\u003e        \"type\": \"fan\",\n\u003e        \"readPath\": \"/xyz/openbmc_project/sensors/fan_tach/BB_FAN0_TACH_RPM\",\n\u003e        \"writePath\": \"/xyz/openbmc_project/control/fanpwm/Pwm_1\",\n\u003e        ...\n\u003e    },\n\u003e    ...\n\u003e    \"zones\" : [\n\u003e    {\n\u003e        \"id\": 1,\n\u003e        ...\n\u003e        \"pids\": [\n\u003e            {\n\u003e                \"name\": \"fan0 1 2 3\",\n\u003e                \"type\": \"fan\",\n\u003e                \"inputs\": [\n\u003e                    \"BB_FAN0_TACH_RPM\",\n\u003e                    \"BB_FAN1_TACH_RPM\",\n\u003e                    \"BB_FAN2_TACH_RPM\",\n\u003e                    \"BB_FAN3_TACH_RPM\"\n\u003e                ],\n\u003e    ...",
      "parentUuid": "e3fa7688_e0992e2c",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ad18d941_8f19d613",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1001618
      },
      "writtenOn": "2022-12-02T01:11:23Z",
      "side": 1,
      "message": "Hi Patrick,\nWould like to know if you have any concern about this design. Thanks!",
      "parentUuid": "3530a0cd_99da1922",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5261b0df_50a7f6d3",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1001618
      },
      "writtenOn": "2022-12-08T01:10:44Z",
      "side": 1,
      "message": "Gentle reminder, please help to review the design. Thanks!",
      "parentUuid": "ad18d941_8f19d613",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d4872ba1_ecc9baeb",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2022-12-15T15:29:34Z",
      "side": 1,
      "message": "I\u0027m still having a bit of trouble understanding the relationship between this and FanPwm/FanSpeed.\n\n1. We already have FanPwm to represent each fan.  Why do we need a property in the \"Zone\" that the FanPwm is part of?\n\n2. It seems like the primary value here is that we can set the Pwm for the whole Zone?  We could do that with a FanPwm instance representing the zone and the Object.Enable interface to select between the FanPwm for the Zone or the FanPwm for each individual Fan.\n\n3. If we have relationships between this object and other objects (ie, the \u0027string\u0027 portion of the property, those should be object_path and not string values.\n\n4. Why do we use double here but FanPwm and FanSpeed both use an integer?",
      "parentUuid": "5261b0df_50a7f6d3",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "224cab1b_bcd333e3",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1001618
      },
      "writtenOn": "2022-12-16T09:32:22Z",
      "side": 1,
      "message": "Hi Patrick,\n\n1. The FanPwm interface is under each independent control/fanpwm object so we could only set the PWM devices one by one.\nTherefore, we would like to support a method to set all PWM device in one fan zone.\n\n2. Yes, we would like to set the PWM for the whole Zone.\nDo you suggest that we could add a instance representing the zone under /xyz/openbmc_project/control/fanpwm and set the PWM of whole zone by setting the FanPwm target in the instance?\n\nFor example:\n\u003e root@greatlakes:~# busctl tree xyz.openbmc_project.FanSensor\n\u003e `-/xyz\n\u003e   `-/xyz/openbmc_project\n\u003e     |-/xyz/openbmc_project/control\n\u003e     | `-/xyz/openbmc_project/control/fanpwm\n\u003e     |   |-/xyz/openbmc_project/control/fanpwm/Zone_1\n\u003e     |   |-/xyz/openbmc_project/control/fanpwm/Pwm_1\n\u003e     |   |-/xyz/openbmc_project/control/fanpwm/Pwm_2\n\u003e     |   |-/xyz/openbmc_project/control/fanpwm/Pwm_3\n\u003e     |   `-/xyz/openbmc_project/control/fanpwm/Pwm_4\n\nIn this case, we could also set the individual PWM by setting the FanPwm target in each fanpwm/Pwm.\n\n3. I think we could set the individual PWM by setting the FanPwm target in each object_path of PWM devices (e.g. /xyz/openbmc_project/control/fanpwm/Pwm_1).\nTherefore, we might not need to support the method to set individual pwm.\n\n4. I\u0027ll change it to integer. Thanks!",
      "parentUuid": "d4872ba1_ecc9baeb",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b26276a_edbe2dd2",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2022-12-16T14:21:10Z",
      "side": 1,
      "message": "```\nFor example:\nroot@greatlakes:~# busctl tree xyz.openbmc_project.FanSensor\n`-/xyz\n  `-/xyz/openbmc_project\n    |-/xyz/openbmc_project/control\n    | `-/xyz/openbmc_project/control/fanpwm\n    |   |-/xyz/openbmc_project/control/fanpwm/Zone_1\n    |   |-/xyz/openbmc_project/control/fanpwm/Pwm_1\n    |   |-/xyz/openbmc_project/control/fanpwm/Pwm_2\n    |   |-/xyz/openbmc_project/control/fanpwm/Pwm_3\n    |   `-/xyz/openbmc_project/control/fanpwm/Pwm_4\n```\n\nYes, this would match my expectations of a possible dbus layout to solve what I believe you\u0027re trying to achieve.  At each of these paths you would have both a FanPwm interfaces and an Object.Enable interface.  The thermal control code should probably provide preference to Zone if both Zone and individual Pwm are Enabled.",
      "parentUuid": "224cab1b_bcd333e3",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47967b0b_16a9b377",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1001618
      },
      "writtenOn": "2022-12-20T09:16:05Z",
      "side": 1,
      "message": "Hi Patrick \u0026 Josh,\nWe have two designs for the Fan Zone instance.\n\nFirst design:\nThere could be many PWMs in one Fan Zone. \nTherefore, if we want to add Zone_1 under object path: control/fanpwm, the Pwm instances should also be under the Zone_1 instance.\n\nFor example:\n\u003e root@greatlakes:~# busctl tree xyz.openbmc_project.FanSensor\n\u003e `-/xyz\n\u003e   `-/xyz/openbmc_project\n\u003e     |-/xyz/openbmc_project/control\n\u003e     | `-/xyz/openbmc_project/control/fanpwm\n\u003e     |   `-/xyz/openbmc_project/control/fanpwm/Zone_1\n\u003e     |     |-/xyz/openbmc_project/control/fanpwm/Zone_1/Pwm_1\n\u003e     |     |-/xyz/openbmc_project/control/fanpwm/Zone_1/Pwm_2\n\u003e     |     |-/xyz/openbmc_project/control/fanpwm/Zone_1/Pwm_3\n\u003e     |     `-/xyz/openbmc_project/control/fanpwm/Zone_1/Pwm_4\n\nWe also need to add some information of Fan Zone in the configureation of enitity-manager for dbus-sensors and entity-manager services to create the Fan Zone instance.\n\nSecond design:\nWe could add FanPwm interface in object path: /xyz/openbmc_project/settings/fanctrl/zone1 which is created by phosphor-pid-control service.\n\nFor expample:\n\u003e root@greatlakes:~# busctl introspect xyz.openbmc_project.State.FanCtrl /xyz/openbmc_project/settings/fanctrl/zone1\n\u003e NAME                                TYPE      SIGNATURE RESULT/VALUE FLAGS\n\u003e ...\n\u003e xyz.openbmc_project.Control.Mode    interface -         -            -\n\u003e .FailSafe                           property  b         false        emits-change writable\n\u003e .Manual                             property  b         false        emits-change writable\n\u003e xyz.openbmc_project.Control.FanPwm  interface -         -            -\n\u003e .Target                             property  t         178          emits-change writable\n\nTherefore, we could set Manual and Fan Zone PWM in same object path and we could set the PWM for each PWM sensors in object path: control/fanpwm/Pwm_1 for debugging purpose.\n\nWould like to know which design do you prefer.",
      "parentUuid": "8b26276a_edbe2dd2",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6c784876_95581d1b",
        "filename": "yaml/xyz/openbmc_project/Control/FanZone.interface.yaml",
        "patchSetId": 7
      },
      "lineNbr": 8,
      "author": {
        "id": 1000520
      },
      "writtenOn": "2022-12-20T18:43:12Z",
      "side": 1,
      "message": "Personally, I prefer the addition of a new layer below `Zone_X`, creating `Zone_X/Pwm_Y` objects to represent each fan output.\n\nI would rename them, though, to `Zone_X/Fan_Y` because `Fan` has a much clearer meaning than `Pwm`.\n\nThis ties in very well with the feature request here: https://github.com/openbmc/phosphor-pid-control/issues/27\n\nIf you add `Zone_X/Fan_Y` then I can see myself logically adding `Zone_X/Pid_Y` or `Zone_X/Input_Y` objects along the same naming scheme, to create an object to represent each PID input. This would allow that feature request to be realized.",
      "parentUuid": "47967b0b_16a9b377",
      "revId": "053ea20b22f57b62432cf295bcdd0597c9b8a11b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}